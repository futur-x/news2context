"""
演示早停机制的效果
"""

print("=" * 70)
print("早停机制（Early Stopping）演示")
print("=" * 70)

print("""
配置：连续失败 3 次就跳过该源

示例 1: Economist 源（100条新闻，全部失败）
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
❌ 第1条: HTTP 403 - 失败计数: 1/3
❌ 第2条: HTTP 403 - 失败计数: 2/3  
❌ 第3条: HTTP 403 - 失败计数: 3/3
⚠️  触发早停！跳过剩余 97 条新闻
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

时间节省：
  - 之前: 100条 × 30秒 = 50分钟
  - 现在: 3条 × 30秒 = 1.5分钟
  - 节省: 48.5分钟 ✅


示例 2: 混合成功/失败的源（20条新闻）
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
❌ 第1条: 提取失败 - 失败计数: 1/3
❌ 第2条: 提取失败 - 失败计数: 2/3
✅ 第3条: 提取成功 - 失败计数: 0/3 (重置)
✅ 第4条: 提取成功 - 失败计数: 0/3
❌ 第5条: 提取失败 - 失败计数: 1/3
✅ 第6条: 提取成功 - 失败计数: 0/3 (重置)
...继续处理剩余新闻
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

结果: 继续处理，因为没有连续3次失败


示例 3: 部分成功后连续失败（30条新闻）
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
✅ 第1-5条: 提取成功
❌ 第6条: 提取失败 - 失败计数: 1/3
❌ 第7条: 提取失败 - 失败计数: 2/3
❌ 第8条: 提取失败 - 失败计数: 3/3
⚠️  触发早停！跳过剩余 22 条新闻
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

结果: 成功入库 5 条，跳过 22 条


关键特性：
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
1. ✅ 只计算**连续**失败，不是总失败数
2. ✅ 成功一次就**重置**失败计数
3. ✅ 达到阈值立即**跳过**剩余新闻
4. ✅ 节省大量时间，提高采集效率
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━


实际效果预测（30个源，每源平均50条新闻）：
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
假设有 5 个问题源（如 Economist）：
  - 之前: 5源 × 50条 × 30秒 = 125分钟
  - 现在: 5源 × 3条 × 30秒 = 7.5分钟
  - 总节省: 117.5分钟 ≈ 2小时 🚀
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
""")

print("\n配置参数:")
print("  - EARLY_STOP_THRESHOLD = 3  (可在 collector.py 中调整)")
print("  - 建议值: 3-5 次")
print("\n" + "=" * 70)
