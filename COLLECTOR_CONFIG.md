# 采集器配置说明

## 📝 配置文件位置
`config/config.yaml`

## ⚙️ 采集器配置项

```yaml
news_sources:
  collector:
    max_news_per_source: 15  # 每个源最多采集的新闻数量
    early_stop_threshold: 3  # 连续失败多少次后跳过该源
```

### 1. `max_news_per_source` (每源最大新闻数)

**作用**: 限制每个新闻源最多采集多少条新闻

**默认值**: 15

**说明**:
- 有些源（如 V2EX, Economist）可能返回几十甚至上百条新闻
- 设置此参数可以避免单个源占用过多资源和时间
- 只会采集前 N 条新闻，其余自动跳过

**示例**:
```
源 V2EX 原有 50 条新闻，限制为 15 条
源 GitHub 原有 17 条新闻，全部采集
```

**建议值**:
- 快速采集: 10-15 条
- 平衡模式: 15-20 条
- 完整采集: 30-50 条

---

### 2. `early_stop_threshold` (早停阈值)

**作用**: 连续失败多少次后跳过该源的剩余新闻

**默认值**: 3

**说明**:
- 如果连续 N 条新闻提取失败，自动跳过该源剩余所有新闻
- 避免在有问题的源上浪费时间
- 成功一次会重置失败计数

**示例**:
```
❌ 第1条失败 - 计数: 1/3
❌ 第2条失败 - 计数: 2/3
❌ 第3条失败 - 计数: 3/3 → 跳过剩余 47 条
```

**建议值**:
- 严格模式: 2-3 次
- 平衡模式: 3-5 次
- 宽松模式: 5-10 次

---

## 🎯 使用场景

### 场景 1: 快速采集（推荐）
```yaml
max_news_per_source: 10
early_stop_threshold: 3
```
- 适合: 日常快速浏览
- 时间: 约 10-20 分钟
- 数据量: 中等

### 场景 2: 平衡模式（默认）
```yaml
max_news_per_source: 15
early_stop_threshold: 3
```
- 适合: 一般使用
- 时间: 约 20-40 分钟
- 数据量: 较多

### 场景 3: 完整采集
```yaml
max_news_per_source: 50
early_stop_threshold: 5
```
- 适合: 深度研究
- 时间: 约 1-2 小时
- 数据量: 大量

---

## 📊 性能影响

| 配置 | 采集时间 | 数据量 | 适用场景 |
|------|----------|--------|----------|
| 10条/源 | 10-20分钟 | 200-300条 | 快速浏览 |
| 15条/源 | 20-40分钟 | 300-450条 | 日常使用 |
| 30条/源 | 40-80分钟 | 600-900条 | 深度分析 |
| 50条/源 | 1-2小时 | 1000-1500条 | 完整采集 |

*假设 30 个源，50% 成功率*

---

## 🔧 修改配置

1. 编辑配置文件:
```bash
vim config/config.yaml
```

2. 修改参数:
```yaml
news_sources:
  collector:
    max_news_per_source: 20  # 改为 20 条
    early_stop_threshold: 5   # 改为 5 次
```

3. 保存并重新运行采集任务

**注意**: 配置修改后立即生效，无需重启

---

## 📝 日志示例

### 正常采集
```
采集配置: 每源最多 15 条, 连续失败 3 次跳过
源 GitHub 获取到 17 条新闻
源 GitHub 原有 17 条新闻，限制为 15 条
源 GitHub 完成: 成功 15 条, 失败 0 条, 跳过 0 条
```

### 早停触发
```
源 Economist 获取到 100 条新闻
源 Economist 原有 100 条新闻，限制为 15 条
第1条提取失败，连续失败: 1/3
第2条提取失败，连续失败: 2/3
第3条提取失败，连续失败: 3/3
源 Economist 连续 3 条提取失败，跳过剩余 12 条新闻
源 Economist 完成: 成功 0 条, 失败 3 条, 跳过 12 条
```

---

## ✅ 最佳实践

1. **首次使用**: 使用默认值 (15条/源, 3次早停)
2. **时间紧张**: 降低到 10条/源
3. **深度研究**: 提高到 30-50条/源
4. **问题源多**: 降低早停阈值到 2次
5. **网络不稳定**: 提高早停阈值到 5次
